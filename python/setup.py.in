#!/usr/bin/env python
# -*- coding:utf-8 -*-

from setuptools import setup, find_packages, Extension


name = 'Akantu'
version = '3.1.0'
release = '1.0.0'

aka_inc_dirs = "@AKANTU_LIBRARY_INCLUDE_DIRS@".split(';')
aka_inc_dirs += "@AKANTU_PRIVATE_EXTERNAL_INCLUDE_DIR@".split(';')
aka_inc_dirs += "@AKANTU_INTERFACE_EXTERNAL_INCLUDE_DIR@".split(';')
aka_inc_dirs.append(
    "@PROJECT_SOURCE_DIR@/third-party/akantu_iterators/include")
aka_inc_dirs.append(
    "@PROJECT_BINARY_DIR@/src")
aka_inc_dirs.append('@PROJECT_SOURCE_DIR@/python')
aka_inc_dirs += '@PYBIND11_INCLUDE_DIR@'.split(';')


pybind_extension = Extension(
    "py11_akantu",
    ["@PROJECT_SOURCE_DIR@/python/py_aka_common.cc",
     "@PROJECT_SOURCE_DIR@/python/py_aka_error.cc",
     "@PROJECT_SOURCE_DIR@/python/py_akantu.cc",
     "@PROJECT_SOURCE_DIR@/python/py_boundary_conditions.cc",
     "@PROJECT_SOURCE_DIR@/python/py_fe_engine.cc",
     "@PROJECT_SOURCE_DIR@/python/py_group_manager.cc",
     "@PROJECT_SOURCE_DIR@/python/py_mesh.cc",
     "@PROJECT_SOURCE_DIR@/python/py_model.cc",
     "@PROJECT_SOURCE_DIR@/python/py_parser.cc"],
    version=version,
    extra_compile_args=['-std=c++17'],
    libraries=['akantu'],
    library_dirs=["@PROJECT_BINARY_DIR@/src/"],
    # '-g', '-fno-omit-frame-pointer'],  # , '-O0'],
    include_dirs=aka_inc_dirs
)


setup(name=name,
      packages=find_packages(),
      version="0.0.0",
      author="Guillaume Anciaux",
      author_email="guillaume.anciaux@epfl.ch",
      description=("Akantu: Swiss-Made Open-Source Finite-Element Library"),
      license="GPL",
      tests_require=["pytest"],
      install_requires=['numpy'],
      ext_modules=[pybind_extension],
      )
